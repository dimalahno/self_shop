# self_shop — FastAPI интернет-магазин

## Основной функционал

- Каталог товаров с добавлением, редактированием и удалением товаров (CRUD).
- Валидация данных товара (название, цена, изображение).
- Регистрация и авторизация пользователей с хранением пароля в хэшированном виде.
- JWT-аутентификация, хранение токена в cookie.
- Роли пользователей (`user`/`admin`).
- Админ-панель (только для админов, защищена JWT и ролью).
- Навигация по страницам (главная, каталог, корзина, регистрация, вход, админка).

## Основные маршруты

- `/` — главная страница
- `/catalog` — каталог товаров (добавление товара через форму)
- `/cart` — корзина
- `/auth/register` — регистрация пользователя
- `/auth/login` — вход пользователя
- `/admin-panel` — админ-панель (только для админов)

## Работа с пользователями
- Регистрация и вход доступны через HTML-формы.
- После входа выдается JWT-токен и устанавливается cookie `access_token`.
- Для доступа к админ-панели требуется роль `admin`.

## Работа с товарами
- Добавление, редактирование и удаление товаров через API и через форму на `/catalog`.
- Валидация: название не пустое, цена > 0, image_url — валидный URL.

## Миграции
- Используется Alembic для управления схемой БД.
- Примеры команд:
  ```
  alembic revision --autogenerate -m "название_миграции"
  alembic upgrade head
  ```

## Запуск проекта
1. Установите зависимости:
   ```
   pip install -r requirements.txt
   ```
2. Примените миграции:
   ```
   alembic upgrade head
   ```
3. Запустите сервер:
   ```
   uvicorn app.main:app --reload
   ```

## Примечания
- Для теста админ-панели создайте пользователя с ролью `admin` (можно вручную в базе или через миграцию).
- SECRET_KEY для JWT должен быть изменён на уникальный и безопасный в продакшене.

---

**Выполненные задачи:**
- CRUD для товаров с валидацией
- Валидация image_url
- Alembic миграции (image_url, role)
- HTML-формы для регистрации, входа, добавления товара
- JWT-аутентификация и проверка роли
- Админ-панель и её защита
- Навигация между страницами
- Исправление ссылок и редиректов
